SELECT 
        p.id product_id, 
        c2.parent_id category_id 
FROM 
        shopping_product p 

INNER JOIN shopping_offer o ON p.id = o.product_id 
INNER JOIN merchant_breadcrumbs mbc ON mbc.id = o.merchant_breadcrumb_id 
INNER JOIN merchant_categories mc ON mc.id = mbc.merchant_category_id 
INNER JOIN sdc_categories c ON c.id = mc.category_id 
INNER JOIN sdc_categories c2 ON c.parent_id = c2.id 

WHERE 
        mc.category_id  IS NOT NULL 
    AND c.parent_id     IS NOT NULL 
    AND c2.parent_id    IS NOT NULL

